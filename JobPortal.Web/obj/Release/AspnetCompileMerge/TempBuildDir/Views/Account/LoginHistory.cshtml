@using JobPortal.Domain
@using JobPortal.Models
@{
    ViewBag.Title = "Login History";
    Layout = "~/Views/Shared/_Layout.cshtml";
    UserInfoEntity user = null;
    if (User != null)
    {
        user = User.Info;
    }
}
<div class="row">
    <div class="col-lg-9 col-md-9">
        <div class="title-login">
            <h1 style="margin-top: -15px">
                Login History
            </h1>
            Manage login history here
        </div>
    </div>
    <div class="col-lg-3 col-md-3">
        @if (user.Type == 4 && user.PromoteDate == null || (user.PromoteDate.Value.Date < DateTime.Now.Date))
        {
            <a href="/package/promote?id=@user.Id&type=P&returnUrl=@Request.Url.ToString()" class="btn btn-info promote pull-right" style="width:150px;">Promote Profile</a>
        }
    </div>
</div>
<div class="clear" style="height:15px"></div>
<div>
    @{
        if (ViewBag.Model != null && ViewBag.Model.Count > 0)
        {
            foreach (var item in ViewBag.Model)
            {
                string cname = "";
                if (!item.IPAddress.Equals("::1"))
                {
                    LocationEntity entity = DomainService.Instance.GetLocation(item.IPAddress);
                    cname = entity.CountryName;
                    if (!string.IsNullOrEmpty(entity.StateName))
                    {
                        cname += ", " + entity.StateName;
                    }
                    if (!string.IsNullOrEmpty(entity.City))
                    {
                        cname += ", " + entity.City;
                    }
                }

                <div class="list-group">
                    <div class="list-group-item">
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <i><b>Date &amp; Time:</b></i> @Html.Raw(item.LoginDateTime.ToString("MMM dd, yyyy hh:mm:ss")) (PST)

                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <i><b>Browser:</b></i> @Html.Raw(item.Browser)
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <i><b>IP Address:</b></i> @Html.Raw(item.IPAddress)
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <i><b>Location:</b></i> @Html.Raw(cname)
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="loginGrid">
                <h3>
                    No History Found!
                </h3>
            </div>
        }
    }
</div>